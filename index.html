<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Nutrition Pro</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="main-wrapper">
        <header>
            <h1><i class="fas fa-bolt"></i> AI Nutrition Assistance</h1>
            <p>Tr·ª£ l√Ω dinh d∆∞·ª°ng & ƒê·∫ßu b·∫øp ·∫£o th√¥ng minh</p>
        </header>

        <div class="glass-panel">
            <div class="section-title"><h3><i class="fas fa-calculator"></i> T√≠nh To√°n Kh·∫©u Ph·∫ßn</h3></div>
            <form id="app-form">
                <div class="grid-2-col">
                    <div class="section">
                        <label>Th√¥ng tin c∆° b·∫£n:</label>
                        <div class="input-row">
                            <input type="number" name="age" placeholder="Tu·ªïi" required value="25">
                            <select name="gender"><option value="male">Nam</option><option value="female">N·ªØ</option></select>
                        </div>
                        <div class="input-row">
                            <input type="number" name="weight" placeholder="C√¢n (kg)" required value="70">
                            <input type="number" name="height" placeholder="Cao (cm)" required value="175">
                        </div>
                        <label>C√¥ng vi·ªác & V·∫≠n ƒë·ªông:</label>
                        <select name="job_type">
                            <option value="office">VƒÉn ph√≤ng (√çt ƒëi l·∫°i)</option>
                            <option value="student">H·ªçc sinh/SV</option>
                            <option value="manual">Lao ƒë·ªông tay ch√¢n</option>
                        </select>
                        <select name="exercise_freq">
                            <option value="none">Kh√¥ng t·∫≠p</option>
                            <option value="1-3">1-3 bu·ªïi/tu·∫ßn</option>
                            <option value="4-6">4-6 bu·ªïi/tu·∫ßn</option>
                            <option value="daily">H√†ng ng√†y</option>
                        </select>
                    </div>

                    <div class="section">
                        <label>M·ª•c ti√™u & Ng√¢n s√°ch:</label>
                        <div class="input-row">
                            <select name="goal">
                                <option value="lose">Gi·∫£m c√¢n</option>
                                <option value="maintain" selected>Gi·ªØ c√¢n</option>
                                <option value="gain">TƒÉng c√¢n</option>
                            </select>
                            <input type="number" name="budget" placeholder="Ng√¢n s√°ch (k VNƒê)" required value="50">
                        </div>
                        
                        <label style="color: var(--accent); font-weight: 600; margin-top: 15px;">
                            <i class="fas fa-exclamation-triangle"></i> D·ªã ·ª©ng / Ki√™ng k·ªµ:
                        </label>
                        <input type="text" id="allergy-input" name="allergies" placeholder="VD: T√¥m, S·ªØa, ƒê·∫≠u ph·ªông..." style="border: 1px solid var(--accent);">

                        <button type="submit" class="submit-btn">T√çNH TO√ÅN NGAY</button>
                    </div>
                </div>
            </form>

            <div id="loading" class="hidden">
                <i class="fas fa-spinner fa-spin"></i> ƒêang t·ªëi ∆∞u h√≥a th·ª±c ƒë∆°n...
            </div>

            <div id="result-area" class="hidden">
                <div class="stats-box">
                    <div><span>BMI:</span> <strong id="res-bmi">-</strong></div>
                    <div><span>Calo Ti√™u chu·∫©n:</span> <strong id="res-target">-</strong></div>
                    <div><span>Chi ph√≠:</span> <strong id="t-cost">-</strong> k VNƒê</div>
                </div>
                
                <div class="menu-layout">
                    <div class="menu-col">
                        <h4><i class="fas fa-utensils"></i> Th·ª±c ƒë∆°n g·ª£i √Ω</h4>
                        <p style="font-size: 12px; color: #666; font-style: italic;">(üí° Click v√†o t√™n m√≥n ƒë·ªÉ xem c√°ch n·∫•u)</p>
                        <ul id="menu-list"></ul>
                    </div>
                    <div class="chart-col">
                        <canvas id="nutritionChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="glass-panel" style="margin-top: 30px;">
            <div class="section-title"><h3><i class="fas fa-robot"></i> B·∫øp Tr∆∞·ªüng AI</h3></div>
            
            <div class="chef-interface">
                <p>Ch·ªçn nguy√™n li·ªáu b·∫°n c√≥ ho·∫∑c Scan t·ªß l·∫°nh:</p>
                
                <div class="scan-area">
                    <label for="fridge-upload" class="upload-btn">
                        <i class="fas fa-camera"></i> Scan t·ªß l·∫°nh
                    </label>
                    <input type="file" id="fridge-upload" accept="image/*" hidden>
                    <span id="upload-status"></span>
                </div>

                <div class="input-row" style="margin: 15px 0;">
                    <input type="number" id="people-count" placeholder="S·ªë ng∆∞·ªùi ƒÉn" value="2" style="width: 48%;">
                    <input type="number" id="dish-count" placeholder="S·ªë m√≥n (ƒë·ªÉ tr·ªëng AI t·ª± ch·ªçn)" style="width: 48%;">
                </div>

                <div class="tags-group" id="ingredient-list">
                    {% for food in foodList %}
                    <label class="tag-check">
                        <input type="checkbox" value="{{ food }}"> {{ food }}
                    </label>
                    {% endfor %}
                </div>

                <button type="button" id="btn-suggest" class="submit-btn" style="background: linear-gradient(135deg, #6c5ce7, #a29bfe); margin-top: 20px;">
                    <i class="fas fa-magic"></i> S√°ng t·∫°o c√¥ng th·ª©c
                </button>
            </div>

            <div id="chef-result" class="hidden" style="margin-top: 25px; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                <h4 style="color: #6c5ce7; margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px;">üßë‚Äçüç≥ G·ª£i √Ω t·ª´ B·∫øp Tr∆∞·ªüng:</h4>
                <div id="chef-content" style="line-height: 1.8; color: #2d3436; font-size: 15px;"></div>
            </div>
        </div>
    </div>

    <div id="sub-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3 id="sub-title">T√¨m m√≥n thay th·∫ø</h3>
            <div id="sub-loading" class="hidden"><i class="fas fa-spinner fa-spin"></i> ƒêang t√¨m...</div>
            <div id="sub-result"></div>
        </div>
    </div>

    <div id="chef-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 style="color: var(--chef-color); text-align: center; margin-bottom: 20px;">
                <i class="fas fa-hat-chef"></i> C√¥ng Th·ª©c N·∫•u ƒÇn
            </h2>
            <div id="recipe-popup-content" style="line-height: 1.6;"></div>
        </div>
    </div>

    <button id="chat-launcher" title="Chat v·ªõi chuy√™n gia">
        <i class="fas fa-comments"></i>
    </button>

    <div id="chat-window" class="hidden">
        <div class="chat-header">
            <span><i class="fas fa-robot"></i> Tr·ª£ L√Ω Dinh D∆∞·ª°ng</span>
            <button id="close-chat"><i class="fas fa-times"></i></button>
        </div>
        <div class="chat-body" id="chat-messages">
            <div class="message bot-msg">
                Xin ch√†o! T√¥i l√† AI Dinh d∆∞·ª°ng. B·∫°n c·∫ßn h·ªèi g√¨ v·ªÅ calo hay th·ª±c ph·∫©m kh√¥ng? ü•¶
            </div>
        </div>
        <div class="chat-footer">
            <input type="text" id="chat-input" placeholder="H·ªèi g√¨ ƒë√≥...">
            <button id="send-btn"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

        <div id="mascot-wrapper">
                <div class="speech-bubble hidden" id="mascot-bubble">
                    Ch√†o! M√¨nh l√† AI N·∫•u ƒÇn ü•ï
                </div>
                <img src="{{ url_for('static', filename='mascot.png') }}" 
                    alt="AI Mascot" 
                    id="mascot-image">
            </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
